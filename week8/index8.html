<!DOCTYPE html>
<html>
<head>
  <script src="https://code.jquery.com/jquery-3.6.3.min.js"></script>
  <link rel="stylesheet" href="../style.css" /> 
</head>
<body>
    <h1> NICHOLAS VIALPANDO</h1>
    <h1> IT 121 - HW 8 Sunny With A Chance Of Awesome   
    <h1>23 January 2023</h1>
    
    <a href=../index.html>Back To Contents</a> 

    <h1>HTTP Requests & Async</h1>
    
    <form id="myform">
      city: <input type="text" name="city"><br>
    
      <button>Get 5 Day Forecast</button>
    </form>
    
    <hr><div id="message"></div>
</body>
</html>

<script>
$(document).ready(() => {
    $('form button').on('click', (e) => {
       //cancel the default form submission
       e.preventDefault();
       //gather up all form-field values
       let city = $('#myform').serialize();
       console.log(city);
       let country = "us";
       let api = "f408b37b6f1efc1d780f3bda17fa8abc";

       //send the request
       $.post("http://api.openweathermap.org/data/2.5/forecast?q=" + city + "," + country + "&APPID=" + api,city, (result, status) => {
          //when the server replies...
          if (status == 'success') {
            $('#message').html(data.main.temp);
          } 
          else {
            $('#message').text('POST failed');
          }
          $('form button').removeAttr('disabled');
       });

     //temporarily disable button to prevent double-submit
     // this happens before post completes
     $('form button').attr('disabled', 'disabled');
    });
});